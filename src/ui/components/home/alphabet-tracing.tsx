import {
  Canvas,
  Circle,
  Fill,
  Mask,
  Morphology,
  Path,
  Skia,
} from "@shopify/react-native-skia";
import clsx from "clsx";
import { useEffect } from "react";
import { View } from "react-native";
import { Gesture, GestureDetector } from "react-native-gesture-handler";
import Animated, {
  useAnimatedStyle,
  useSharedValue,
} from "react-native-reanimated";

import { WIDTH } from "@/utils/layout";

const letterCoordinatesToRender = {
  n: "M 8.7 89.465 C 17.523 89.956 24.277 97.507 23.785 106.33 C 22.163 135.338 18.284 174.627 21.808 197.649 C 20.62 189.36 13.24 183.389 4.886 183.957 C -3.469 184.524 -9.973 191.438 -10.03 199.812 C -9.936 188.497 -10.952 171.535 -9.797 154.795 C -8.637 137.976 -3.289 118.088 6.991 105.375 C 14.856 98.007 26.565 92.425 35.632 92.035 C 44.686 91.646 56.002 95.522 63.625 100.288 C 73.022 107.92 79.546 118.76 81.268 127.313 C 82.953 135.684 82.595 144.108 82.932 150.633 C 83.695 168.682 79.382 198.93 79.382 198.93 C 79.346 200.158 79.382 198.93 79.382 198.93 C 79.297 204.642 76.167 209.873 71.174 212.648 C 66.181 215.423 60.086 215.32 55.191 212.377 C 50.295 209.433 47.344 204.099 47.453 198.388 C 47.453 198.388 47.502 197.944 47.453 198.388 C 47.453 198.388 49.912 182.208 50.529 174.647 C 51.148 167.074 51.362 159.964 50.968 152.15 C 50.626 144.237 50.837 138.296 49.897 133.629 C 48.994 129.145 49.698 128.271 45.636 126.753 C 42.221 124.021 40.629 123.849 37.006 124.005 C 33.395 124.16 32.655 123.712 30.39 127.204 C 24.071 132.281 23.136 142.369 22.127 156.998 C 21.112 171.705 22.036 187.663 21.97 200.028 C 21.913 208.402 15.409 215.316 7.054 215.883 C -1.3 216.451 -8.68 210.48 -9.868 202.191 C -13.484 175.413 -9.743 132.962 -8.165 104.55 C -7.674 95.727 -0.123 88.973 8.7 89.465 Z",
  p: "M 17.908203 65.158203 C 9.8069177 65.518837 3.1357031 71.965703 2.6660156 80.236328 C 2.6660156 80.236328 -1.3596875 165.50233 -2.0546875 177.73633 C -3.5606875 204.51533 -5.8035469 258.87158 -5.8105469 278.64258 C -5.8105469 287.47958 1.3524531 294.64258 10.189453 294.64258 C 19.026453 294.64258 26.189453 287.47958 26.189453 278.64258 C 26.183101 261.30175 27.992238 216.55616 29.447266 188.42773 C 33.500639 189.60236 38.217299 190.66883 43.552734 191.33984 C 52.873734 192.51184 65.931562 191.87931 75.976562 187.19531 C 85.875563 182.57931 96.051094 170.81642 101.37109 156.60742 C 107.85209 133.18542 105.39497 111.44297 99.417969 98.292969 C 96.210969 91.236969 91.255266 84.455891 87.197266 80.462891 C 82.653266 75.990891 75.164422 72.194125 70.232422 70.828125 C 56.52834 69.179868 43.018008 71.800024 33.619141 75.539062 C 31.461691 69.783325 26.077855 65.540815 19.546875 65.169922 C 18.9955 65.138609 18.448289 65.134161 17.908203 65.158203 z M 59.025391 101.48828 C 60.558082 101.5206 62.178151 101.73789 63.912109 102.15039 C 63.948994 102.34827 64.165359 102.69241 64.751953 103.26953 C 66.968953 105.45253 68.424156 107.44016 70.285156 111.53516 C 74.446156 120.68816 76.757125 130.78159 70.828125 147.05859 C 69.233125 154.96559 67.110172 156.02136 62.451172 158.19336 C 57.937172 160.29836 54.177922 160.42384 47.544922 159.58984 C 42.216747 158.92007 36.291816 157.22215 31.078125 155.44336 C 31.865352 139.40814 32.359666 129.46697 33.175781 112.30078 C 36.448931 110.14169 40.098179 107.75451 44.074219 105.85156 C 49.290469 103.35556 53.673016 101.37541 59.025391 101.48828 z ",
  t: "M 54.714844 -13.068359 C 51.956219 -13.212734 49.159781 -12.643703 46.613281 -11.345703 C 41.520281 -8.7497031 38.200344 -3.6347812 37.902344 2.0742188 C 37.902344 2.0742188 37.479844 17.286297 37.089844 25.779297 C 36.699844 34.279297 36.213359 43.213172 35.693359 52.076172 C 35.014001 63.642876 34.405541 72.845427 33.775391 82.642578 C 26.738296 82.206666 20.78125 81.914063 20.78125 81.914062 C 15.09425 81.343063 9.5352656 83.849234 6.1972656 88.490234 C 2.8602656 93.130234 2.2505625 99.200156 4.6015625 104.41016 C 6.9515625 109.62116 11.903797 113.18195 17.591797 113.75195 C 17.591797 113.75195 26.494577 113.84364 31.824219 114.1582 C 29.975715 144.41098 28.842293 164.90486 29.142578 177.67383 C 29.329578 185.63683 30.331797 193.14098 32.216797 197.95898 C 33.431797 201.06498 36.322625 205.39683 38.765625 207.54883 C 41.456625 209.91883 46.500688 211.95347 49.429688 212.73047 C 56.142687 213.25547 65.830813 211.5798 71.507812 208.9668 C 77.194813 206.3488 84.491906 200.48856 88.253906 195.72656 C 93.040906 188.29956 90.900656 178.39737 83.472656 173.60938 C 76.045656 168.82237 66.143469 170.96263 61.355469 178.39062 C 61.5413 178.53462 61.476297 178.59134 61.21875 178.68555 C 61.195112 177.99515 61.154548 177.76069 61.134766 176.92188 C 60.866412 165.48509 61.91053 146.47257 63.697266 117.21289 C 69.659836 117.51647 75.953399 117.54049 82.519531 117.01172 C 91.319531 116.20172 97.797281 108.41228 96.988281 99.613281 C 96.178281 90.813281 88.388844 84.335531 79.589844 85.144531 C 74.749517 85.662632 70.226597 85.671558 65.666016 85.408203 C 66.306831 75.437665 66.933603 65.924916 67.636719 53.951172 C 68.685719 36.091172 69.857422 3.7460937 69.857422 3.7460938 C 70.156422 -1.9619062 67.386797 -7.3967656 62.591797 -10.509766 C 60.194797 -12.066266 57.473469 -12.923984 54.714844 -13.068359 z ",
  i: "M 49.90625 33.138672 C 49.78449 33.138374 49.642111 33.149143 49.513672 33.152344 C 47.514642 33.089949 45.543753 33.404794 43.697266 34.056641 C 42.938528 34.271117 42.251071 34.513473 41.714844 34.775391 C 39.984844 35.620391 37.299828 37.989906 36.048828 39.253906 C 35.536848 39.872572 35.343719 40.361203 35.402344 40.738281 C 34.869206 41.603532 34.408092 42.530519 34.037109 43.517578 C 34.037109 43.517578 32.838641 41.641797 31.306641 45.716797 C 30.380641 48.183797 29.720469 54.930891 31.230469 58.837891 C 32.213469 61.380891 36.179594 66.191578 39.183594 67.767578 C 41.616594 69.044578 46.654562 69.603859 49.226562 69.630859 C 52.715563 68.687859 58.128875 66.465125 60.171875 64.578125 C 62.259875 62.648125 64.960219 56.668813 66.199219 52.507812 C 65.850219 48.734813 64.239953 41.913422 62.001953 39.232422 C 61.05959 38.103851 58.504643 36.182556 55.722656 34.798828 C 55.503914 34.570027 55.150533 34.358882 54.642578 34.167969 C 53.977731 33.918169 53.306302 33.719729 52.632812 33.5625 C 52.019802 33.383426 51.419628 33.248525 50.849609 33.185547 C 50.570234 33.154547 50.252754 33.13952 49.90625 33.138672 z M 46.271484 81.560547 C 43.512109 81.676672 40.783094 82.506563 38.371094 84.039062 C 33.546094 87.103062 30.723797 92.510703 30.966797 98.220703 C 30.966797 98.220703 30.374078 130.53461 31.580078 147.34961 C 32.786078 164.16461 35.061422 181.3785 38.232422 197.9375 C 39.901422 206.6155 48.289797 212.29595 56.966797 210.62695 C 65.644797 208.95795 71.32525 200.56958 69.65625 191.89258 C 66.63725 176.27158 64.637047 160.93555 63.498047 145.06055 C 62.929047 137.12355 62.605859 129.40522 62.505859 121.44922 C 62.405859 113.49222 62.923828 96.873047 62.923828 96.873047 C 62.685828 91.163047 59.419516 86.014187 54.353516 83.367188 C 51.821016 82.043187 49.030859 81.444422 46.271484 81.560547 z ",
  a: "M 48.439453 -13.345703 C 41.528453 -12.848703 35.724594 -7.959375 34.058594 -1.234375 C 25.771594 32.213625 16.643125 68.027359 8.703125 102.19336 C 2.918125 127.31236 -4.3850469 169.02952 -6.4980469 178.10352 C -7.6030469 183.05152 -9.9238281 197.86328 -9.9238281 197.86328 C -11.276828 206.59628 -5.2945 214.772 3.4375 216.125 C 12.1705 217.478 20.346219 211.49567 21.699219 202.76367 C 21.699219 202.76367 23.780781 189.17622 24.675781 185.32422 C 26.766401 176.25055 33.030868 140.77646 38.382812 116.17773 C 45.987131 116.09266 53.202477 116.01601 61.767578 115.92383 C 64.910327 135.7418 66.995367 155.80449 69.279297 177.01953 C 70.134297 184.56653 70.158688 186.87511 71.554688 196.41211 L 72.453125 202.61133 C 73.722125 211.35633 81.841937 217.41744 90.585938 216.14844 C 99.330937 214.87944 105.39009 206.75963 104.12109 198.01562 L 103.22266 191.81641 C 102.01866 184.75341 102.04266 182.86237 101.09766 173.60938 C 97.302656 138.35337 93.6965 103.91541 84.6875 68.441406 C 83.6485 64.397406 74.220203 21.019031 64.408203 -3.4179688 C 61.796203 -9.8349688 55.350453 -13.842703 48.439453 -13.345703 z M 50.8125 63.960938 C 52.3145 70.370937 52.517453 71.786625 53.689453 76.390625 C 54.327513 78.851131 54.879959 81.298442 55.460938 83.75 C 52.182988 83.779605 48.939685 83.820812 45.902344 83.875 C 47.560089 77.026745 48.665441 72.665384 50.8125 63.960938 z ",
  I: "M 69.857422 -12.277344 C 60.877422 -12.239344 52.169797 -12.0885 43.716797 -11.9375 C 34.503797 -11.7385 14.181188 -11.896344 11.867188 -11.902344 C 7.2381875 -11.915344 2.5859375 -11.939453 2.5859375 -11.939453 C -6.2510625 -11.986453 -13.453 -4.8613906 -13.5 3.9746094 C -13.547 12.811609 -6.4219375 20.013547 2.4140625 20.060547 C 2.4140625 20.060547 28.227672 20.169594 20.763672 20.058594 C 20.763672 20.058594 27.175882 20.142066 34.296875 20.138672 C 34.297581 25.506836 34.305325 28.424056 34.294922 32.470703 C 34.271922 41.807703 34.2305 51.042875 34.1875 60.296875 C 34.0995 78.803875 34 97.366766 34 116.75977 C 34 122.2995 33.4943 154.98193 33.609375 180.13477 C 22.587224 180.02212 10.909595 179.80268 9.7675781 179.79883 C 6.2075781 179.78583 2.5566406 179.75977 2.5566406 179.75977 C -6.2803594 179.72877 -13.469 186.86712 -13.5 195.70312 C -13.531 204.54012 -6.3926406 211.72877 2.4433594 211.75977 C 2.4433594 211.75977 6.04125 211.78487 9.65625 211.79688 C 11.46325 211.80387 13.304062 211.80773 14.664062 211.80273 C 15.357063 211.80073 38.932703 212.35525 50.095703 212.15625 C 50.130688 212.15556 50.168107 212.15498 50.203125 212.1543 C 65.630781 211.8555 84.271501 212.54944 97.984375 212.15234 C 106.81637 211.88434 113.75919 204.50878 113.49219 195.67578 C 113.22419 186.84378 105.84863 179.90097 97.015625 180.16797 C 88.417117 180.44109 77.09054 180.21382 65.601562 180.12695 C 65.481038 155.3648 66 122.54749 66 116.75977 C 66 97.452766 66.1005 78.965266 66.1875 60.447266 C 66.2315 51.188266 66.271922 41.918734 66.294922 32.552734 C 66.305714 28.340542 66.297835 25.281121 66.296875 19.757812 C 67.535361 19.748346 68.742352 19.727929 69.992188 19.722656 C 78.767188 19.685656 97.568359 20.060547 97.568359 20.060547 C 106.40436 20.023547 113.537 12.829188 113.5 3.9921875 C 113.463 -4.8438125 106.26864 -11.976453 97.431641 -11.939453 C 97.431641 -11.939453 78.832422 -12.315344 69.857422 -12.277344 z ",
  A: "M 56.99 131.58 C 64.766 135.777 74.472 132.876 78.67 125.1 C 82.867 117.324 79.966 107.618 72.19 103.42 C 72.19 103.42 72.794 103.782 72.19 103.42 C 72.19 103.42 64.922 98.243 61.061 96.159 C 56.936 93.933 51.807 91.95 47.753 91.164 C 38.887 89.445 28.713 92.443 21.379 96.263 C 13.455 101.219 4.799 110.521 -0.229 119.791 C -5.121 128.81 -9.009 140.985 -10.601 151.925 C -11.556 160.084 -11.165 170.946 -8.436 179.504 C -5.682 188.14 1.802 198.253 10.348 204.503 C 20.132 209.471 32.824 211.138 40.599 209.437 C 48.772 207.648 57.879 201.761 62.12 197.428 C 70.31 187.707 77.921 175.503 80.416 159.057 C 81.343 146.518 81.766 133.123 80.891 120.058 C 80.541 115.047 80.19 110.038 79.829 105.013 C 79.203 96.304 71.711 89.705 62.993 90.184 C 54.275 90.663 47.55 98.043 47.882 106.768 C 48.572 124.928 49.261 143.085 49.951 161.244 C 50.277 169.921 51.12 183.503 57.855 194.051 C 61.611 199.933 69.741 206.233 76.222 208.459 C 79.596 209.618 84.947 210.429 88.77 210.144 C 92.635 209.856 98.457 207.689 102.285 205.513 C 109.627 200.594 111.591 190.656 106.673 183.315 C 101.754 175.973 91.816 174.009 84.475 178.927 C 84.743 179.136 86.606 178.217 86.392 178.233 C 86.135 178.252 87.285 178.424 86.616 178.194 C 85.009 177.642 85.679 178.167 84.826 176.829 C 82.34 172.937 82.243 168.475 81.928 160.033 C 81.238 141.873 80.548 123.713 79.858 105.553 C 80.19 114.277 73.465 121.657 64.747 122.136 C 56.029 122.615 48.537 116.016 47.911 107.307 C 48.27 112.302 48.62 117.293 48.969 122.302 C 49.814 133.697 49.397 144.783 48.504 156.683 C 49.179 164.697 45.306 167.759 37.68 176.772 C 37.501 177.669 37.023 177.462 33.759 178.176 C 30.096 178.978 29.496 179.968 27.451 177.457 C 23.727 175.946 23.497 174.315 22.051 169.781 C 20.58 165.169 20.288 161.431 21.121 156.131 C 22.04 148.122 24.351 141.59 27.899 135.049 C 31.311 128.759 33.339 125.649 36.886 124.255 C 40.811 121.837 39.863 122.23 41.662 122.579 C 42.941 122.827 43.503 123.046 45.861 124.318 C 48.483 125.734 56.99 131.58 56.99 131.58 C 56.386 131.218 56.99 131.58 56.99 131.58 Z",
  N: "M 6.9509816 -13.099589 C 5.8984358 -13.123168 4.8355414 -13.040931 3.7752004 -12.849589 C 2.1676308 -12.562855 0.64183248 -12.033056 -0.76386213 -11.302714 C -0.88961345 -11.23771 -1.0057065 -11.161702 -1.1290965 -11.09373 C -1.4582378 -10.911536 -1.7872079 -10.729623 -2.1017528 -10.52537 C -2.3688347 -10.352648 -2.6190822 -10.16139 -2.8732371 -9.9745889 C -3.0249426 -9.8628044 -3.1826929 -9.759519 -3.3302684 -9.6425576 C -3.6184572 -9.4145677 -3.8886428 -9.1693612 -4.1583934 -8.9238076 C -4.2699936 -8.8222448 -4.3875889 -8.7276807 -4.496284 -8.6230264 C -4.7343825 -8.393586 -4.9556362 -8.1507838 -5.1779246 -7.9081826 C -5.3095917 -7.7648312 -5.4460079 -7.6266161 -5.5724559 -7.4784951 C -5.7571038 -7.2615644 -5.92555 -7.034389 -6.0978465 -6.8085733 C -6.2426538 -6.6195298 -6.3910858 -6.4338666 -6.527534 -6.2382608 C -6.6614327 -6.0455133 -6.7813102 -5.8445984 -6.9064403 -5.6464639 C -7.0608964 -5.4029218 -7.2181178 -5.1624417 -7.3595653 -4.9101358 C -7.4493375 -4.7494598 -7.5273576 -4.5834735 -7.6115184 -4.4199014 C -7.7691669 -4.1144398 -7.9264539 -3.808833 -8.0646434 -3.492167 C -8.1132538 -3.3806328 -8.1513848 -3.2649344 -8.1974559 -3.1523233 C -8.3460677 -2.7893044 -8.4912996 -2.4248131 -8.6134715 -2.0488076 C -8.6581003 -1.9118717 -8.6897048 -1.770952 -8.730659 -1.632792 C -8.833357 -1.28485 -8.9365233 -0.9376305 -9.0158153 -0.58005764 C -9.0773959 -0.30492317 -9.1152389 -0.024695031 -9.1622996 0.25392674 C -9.2004766 0.48285408 -9.251107 0.70727677 -9.2794871 0.93947361 C -9.347676 1.4877399 -9.3878655 2.0411738 -9.3986278 2.5976767 C -9.4033567 2.7219338 -10.088744 20.735803 -10.299018 29.765645 C -10.510018 38.827645 -10.636409 47.882692 -10.699409 56.888692 C -10.824409 74.900692 -10.698237 93.040161 -10.498237 111.86916 C -10.298237 128.82216 -10.399237 143.88441 -9.9982371 167.27541 C -9.7962371 176.18441 -10.494331 201.46291 -10.494331 201.46291 C -10.736331 210.29591 -3.7716903 217.65255 5.0623097 217.89455 C 13.89531 218.13655 21.25195 211.17191 21.49395 202.33791 C 21.49395 202.33791 22.193857 176.43015 21.997857 166.70315 C 21.598857 143.69415 21.69981 128.7645 21.49981 111.5215 C 21.388813 101.1045 21.313714 90.995553 21.279107 80.998067 C 25.797283 91.110762 30.441513 100.94644 35.15606 109.88283 C 45.28106 128.93883 54.216747 146.60179 63.710747 166.88479 C 72.703747 186.02379 78.830732 196.16397 84.169732 208.37697 C 87.180732 215.17797 94.481872 219.00716 101.78887 217.61916 C 109.09487 216.23016 114.48192 209.98961 114.78692 202.55861 C 115.79192 177.72461 114.99664 146.29793 115.29864 123.00393 C 115.66664 84.833927 119.45676 41.77827 117.37676 2.0312705 C 116.89676 -6.7927295 109.35406 -13.556151 100.53106 -13.076151 C 91.70706 -12.596151 84.943638 -5.0534483 85.423638 3.7695517 C 87.543638 41.222552 83.733591 83.188349 83.300591 122.61135 C 83.257166 126.09508 83.270963 129.96404 83.265435 133.70315 C 76.819156 120.55764 70.361134 107.94321 63.443169 94.917989 C 55.933169 80.762989 48.726482 64.485083 41.638482 47.414083 C 38.094482 38.878083 34.650107 30.294849 31.279107 21.798849 C 27.920622 13.334391 21.557063 -2.7898572 21.509575 -2.9101358 C 21.301923 -3.4422519 21.065836 -3.9598665 20.804497 -4.4628701 C 20.730537 -4.6059479 20.644013 -4.7388672 20.566216 -4.8788858 C 20.394202 -5.186978 20.222469 -5.4957684 20.03106 -5.7909951 C 19.860404 -6.0553492 19.672536 -6.302955 19.488091 -6.554667 C 19.369734 -6.7157808 19.25876 -6.8825744 19.134575 -7.039042 C 18.913825 -7.3176364 18.676456 -7.5784816 18.439263 -7.8398233 C 18.332524 -7.9574619 18.233024 -8.0808705 18.122857 -8.195292 C 17.896786 -8.4298931 17.658585 -8.6479122 17.419732 -8.867167 C 17.271855 -9.0032643 17.129335 -9.1448352 16.976372 -9.2753701 C 16.77379 -9.447687 16.559759 -9.6040475 16.349419 -9.7656045 C 16.143505 -9.9243931 15.942074 -10.087479 15.728325 -10.236308 C 15.555223 -10.356356 15.374527 -10.463164 15.197075 -10.576151 C 14.93271 -10.745181 14.669098 -10.914701 14.394341 -11.068339 C 14.246618 -11.150653 14.093338 -11.22123 13.943169 -11.298808 C 13.636283 -11.457843 13.329764 -11.616465 13.011528 -11.755839 C 12.854526 -11.824519 12.692138 -11.879702 12.533013 -11.943339 C 12.214952 -12.070565 11.898034 -12.199568 11.570122 -12.30662 C 11.367827 -12.372868 11.159825 -12.420288 10.954888 -12.478495 C 10.670701 -12.558803 10.389927 -12.646118 10.099419 -12.710917 C 9.7270448 -12.79476 9.349118 -12.852977 8.9705129 -12.910136 C 8.839319 -12.929655 8.7121302 -12.960216 8.5798879 -12.976542 C 8.0411235 -13.044233 7.4977884 -13.08734 6.9509816 -13.099589 z ",
  P: "M 26.449219 -14.226562 C 20.418219 -14.227937 14.541391 -14.089969 9.4628906 -14.042969 C 6.5518891 -14.014966 3.838452 -13.197621 1.5 -11.816406 C -3.5695345 -9.1579846 -7.0439173 -3.8653626 -7.0820312 2.2578125 C -7.0820312 2.2578125 -7.1513281 29.968469 -7.2363281 43.855469 C -7.3223281 57.742469 -7.4251406 71.671516 -7.4941406 85.603516 C -7.6321406 113.46752 -7.6310781 141.46678 -7.0800781 169.17578 C -6.8810781 177.47478 -7.1816406 198.02539 -7.1816406 198.02539 C -7.3096406 206.86139 -0.2490625 214.12886 8.5859375 214.25586 C 17.421937 214.38386 24.687453 207.32328 24.814453 198.48828 C 24.814453 198.48828 25.112109 177.43953 24.912109 168.51953 C 24.553855 150.61271 24.470878 132.59295 24.466797 114.51953 C 27.588232 114.43072 30.792228 114.31222 33.769531 114.12109 C 42.573531 113.42509 55.051281 110.5747 62.613281 108.2207 C 76.407281 103.2637 85.57425 96.877578 90.40625 92.892578 C 99.33825 83.688578 105.5642 68.110203 106.9082 56.658203 C 108.2702 45.056203 106.86414 31.667078 104.86914 25.330078 C 104.65414 24.933078 103.02919 19.540422 99.742188 13.857422 C 96.779188 8.7344219 89.875438 1.2101719 81.773438 -3.7988281 C 70.213438 -9.4558281 57.527328 -12.256359 44.361328 -13.568359 C 38.664828 -14.083859 32.480219 -14.225188 26.449219 -14.226562 z M 26.0625 17.716797 C 31.4575 17.690672 36.671891 17.798703 41.275391 18.283203 C 52.908391 19.371203 59.648141 20.396625 66.869141 24.515625 C 69.958141 25.406625 70.305969 26.878859 72.042969 29.880859 C 73.455969 32.322859 74.076156 34.335656 74.785156 36.222656 C 75.889156 38.486656 76.114953 44.506687 75.126953 52.929688 C 74.120953 61.502687 73.995344 66.526656 70.027344 68.222656 C 65.659344 71.837656 62.025531 75.250359 53.019531 77.693359 C 46.581531 79.739359 37.849297 81.887406 31.654297 82.191406 C 29.510797 82.337156 27.033781 82.447672 24.523438 82.53125 C 24.59167 69.712117 24.68238 56.88168 24.761719 44.052734 C 24.81613 35.253934 24.833697 27.064169 24.861328 17.734375 C 25.260892 17.731085 25.664715 17.718723 26.0625 17.716797 z ",
  T: "M 71.888672 -12.214844 C 62.017672 -12.176844 52.444578 -12.025 43.142578 -11.875 C 33.003578 -11.676 10.566672 -11.833844 8.0136719 -11.839844 C 2.9076719 -11.852844 -2.2226562 -11.876953 -2.2226562 -11.876953 C -11.059656 -11.919953 -18.257781 -4.7910781 -18.300781 4.0449219 C -18.343781 12.881922 -11.214906 20.080047 -2.3789062 20.123047 C -2.3789063 20.123047 2.7915469 20.148156 7.9355469 20.160156 C 10.507547 20.167156 13.103156 20.169063 15.035156 20.164062 C 16.011156 20.162063 16.881422 20.158391 17.482422 20.150391 C 17.717136 20.147502 25.755567 20.233743 34.197266 20.208984 C 34.197967 25.5744 34.205709 28.48912 34.195312 32.533203 C 34.172313 41.870203 34.130891 51.105375 34.087891 60.359375 C 33.999891 78.866375 33.900391 97.429266 33.900391 116.82227 C 33.900391 123.67427 33.005031 172.51036 33.707031 196.69336 C 33.967031 205.52636 41.337922 212.4768 50.169922 212.2168 C 59.002922 211.9568 65.953359 204.58591 65.693359 195.75391 C 64.995359 172.33691 65.900391 123.97027 65.900391 116.82227 C 65.900391 97.515266 66.000891 79.029719 66.087891 60.511719 C 66.131891 51.252719 66.172313 41.981234 66.195312 32.615234 C 66.206092 28.408186 66.198217 25.354093 66.197266 19.835938 C 68.139216 19.820047 70.045672 19.792875 72.011719 19.785156 C 81.696719 19.748156 102.36133 20.123047 102.36133 20.123047 C 111.19833 20.089047 118.33478 12.8985 118.30078 4.0625 C 118.26678 -4.7745 111.07428 -11.910953 102.23828 -11.876953 C 102.23828 -11.876953 81.753672 -12.252844 71.888672 -12.214844 z ",
};

const getPathStartPoint = (pathData: string): { x: number; y: number } => {
  const match = pathData.match(/M\s*(-?\d+(\.\d+)?)\s*(-?\d+(\.\d+)?)/);
  if (match) {
    return { x: parseFloat(match[1]), y: parseFloat(match[3]) };
  }
  return { x: 0, y: 0 }; // Default to (0, 0) if no match found
};

type AlphabetTracingProps = {
  letter: string;
  isOverlayAnimation: boolean;
};

const STROKE_WIDTH = 50;

const radius = 40;

const AlphabetTracing = ({
  letter,
  isOverlayAnimation,
}: AlphabetTracingProps) => {
  const letterPath = Skia.Path.MakeFromSVGString(
    letterCoordinatesToRender[letter as "A" | "T" | "P" | "I" | "N"],
  )!;
  const drawPath = useSharedValue(Skia.Path.Make());

  const x = useSharedValue(50);
  const y = useSharedValue(50);

  const style = useAnimatedStyle(() => ({
    position: "absolute",
    top: -radius,
    left: -radius,
    width: radius * 2,
    zIndex: 50,
    height: radius * 2,
    transform: [{ translateX: x.value }, { translateY: y.value }],
  }));

  const gesture = Gesture.Pan()
    .onBegin((event) => {
      drawPath.value.moveTo(event.x, event.y);
      drawPath.modify();
    })
    .onChange((event) => {
      x.value = event.x;
      y.value = event.y;
      drawPath.value.lineTo(event.x, event.y);
      drawPath.modify();
    });

  const canvasWidth = WIDTH;
  const canvasHeight = 256;

  // Get the bounding box of the letter path
  const bounds = letterPath.getBounds();

  // Calculate the scaling factor to fit the letter within the canvas
  const scale =
    Math.min(canvasWidth / bounds.width, canvasHeight / bounds.height) * 0.8; // 0.8 to leave some margin
  console.log({ scale });
  console.log({ canvasWidth });
  console.log(bounds.width, "bounds.width");
  // Calculate the translation to center the letter
  const centerX = canvasWidth / 2 - (bounds.x + bounds.width / 2) * scale;
  const centerY = canvasHeight / 2 - (bounds.y + bounds.height / 2) * scale;

  const matrix = Skia.Matrix();
  matrix.scale(scale, scale);
  matrix.translate(centerX / scale, centerY / scale);
  letterPath.transform(matrix);

  useEffect(() => {
    drawPath.value = Skia.Path.Make();
    const startPoint = getPathStartPoint(
      letterCoordinatesToRender[letter as "A" | "T" | "P" | "I" | "N"],
    );
    x.value = startPoint.x * scale + centerX;
    y.value = startPoint.y * scale + centerY;
  }, [letter, drawPath, x, y, scale, centerX, centerY]);

  return (
    <GestureDetector gesture={gesture}>
      <View
        className={clsx(
          "relative  h-72 w-full items-center justify-center border-pink-500",
          {
            "pointer-events-none -z-20": isOverlayAnimation,
            "z-20": !isOverlayAnimation,
          },
        )}
      >
        <Canvas
          style={{
            height: canvasHeight,
            width: canvasWidth,
          }}
        >
          <Fill color="white" />
          {/* Letter black border */}
          <Path path={letterPath} color="#E4E4E7" strokeWidth={10 / scale}>
            <Morphology radius={6 / scale} />
          </Path>

          {/* Letter white background */}
          <Path path={letterPath} color="#E4E4E7" strokeWidth={10 / scale}>
            <Morphology radius={3 / scale} />
          </Path>

          <Mask
            mask={
              <Path
                path={drawPath}
                color="black"
                strokeWidth={STROKE_WIDTH}
                style="stroke"
              />
            }
          >
            <Path path={letterPath} color="black" strokeWidth={10 / scale} />
          </Mask>
          {!isOverlayAnimation && (
            <Circle cx={x} cy={y} r={12} color="#C385F8" />
          )}
        </Canvas>
        <Animated.View style={style} className={"z-50"} />
      </View>
    </GestureDetector>
  );
};

export default AlphabetTracing;
